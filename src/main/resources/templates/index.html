<!--%@ page isELIgnored="false" %>
<%@ page contentType="text/html; charset=utf-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">

    <title>Интернет-магазин "АВРОРА". Самый большой выбор звездолетов и планетарных станций в 9 вселенных. В наличии и под заказ</title>

    <link rel="stylesheet" href="css/style.css" type="text/css">

    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>

    <script type="text/javascript" src="js/products.js"></script>

    <script type="text/javascript" src="js/users.js"></script>

    <link rel="shortcut icon" href="images/favicon.ico" />

    <!--<th:edit="${"/images/pencil.png"}>-->
    <!--<th:url value="/images/delete.png" var="delete" />-->


</head>

<body>

<div id="header">
</div>

<div id="main" class="main">

    <div id="shoppingCart">
        <div id="cartItemsContainer">
            <h1>Корзина</h1>
            <b class="openCloseCart" aria-hidden="true">x</b>
            <div id="cartItems"></div>
            <div>Сумма товаров:
                <span id="productsAmount"></span>
            </div>
            <div>Скидка:
                <span id="discountSize"></span>%
                <span id="discountAmount"></span>
            </div>
            <div>Итого:
                <span id="productsTotal"></span>
            </div>
            <button id="registerOrder">Оформить заказ</button>
        </div>
    </div>

    <div id="searchWindow">
        <div id="searchItemsContainer">
            <h1>Поиск</h1>
            <b class="openCloseSearch" aria-hidden="true">x</b>
            Найти:
            <input id="findText">
            <button id="findProducts" onclick="findProducts()">Найти</button>
            <div id="searchItems"></div>
        </div>
    </div>


    <div id="AddProductWindow">
        <div id="AddProductContainer">
            <h1>Товар</h1>
            <b class="openCloseAddProduct" aria-hidden="true">x</b>
            <div id="ProductWindow2"></div>
            <!--<div id="ProductWindow">-->

            <!--<div th:text = ${product.id}></div>-->
                <!--<div th:text = ${product.name}></div>-->
            <!--&lt;!&ndash;<form action="/products/new" method="post">&ndash;&gt;-->
            <!--<form action="/products/add" method="post"> &lt;!&ndash;id="productEdit"&ndash;&gt;-->


                <!--<label>Id:</label>-->
                <!--<input required type="text" name="id" placeholder="Id">-->
                <!--<br />-->

                    <!--<label>Наименование:</label>-->
                    <!--<input required type="text" name="name" placeholder="Наименование">-->
                    <!--<br />-->

                    <!--<label>Цена:</label>-->
                    <!--<input required type="text" name="price" placeholder="Цена"><br />-->

                <!--<label>Категория:</label>-->
                <!--<input required type="text" name="category" placeholder="Категория"><br />-->

                <!--&lt;!&ndash;input type="submit" value="Сохранить"&ndash;&gt;-->
                    <!--&lt;!&ndash;<button&ndash;&gt;-->
                        <!--&lt;!&ndash;th:with="text=${product['new']} ? 'Добавить товар' : 'Сохранить товар'"&ndash;&gt;-->
                        <!--&lt;!&ndash;type="submit" th:text="${text}">Добавить товар</button>&ndash;&gt;-->
                <!--<button type="submit">Добавить товар</button>-->

                <!--</form>-->

            <!--</div>-->

        </div>
    </div>




    <!--c:forEach items="${categories}" var="category"-->
    <div th:each="category : ${categories}">

        <div class="category">
            <H2 th:text=${category.name}></H2>
            <hr>
        </div>


        <!--  Кнопки админа -->
        <button id="openCloseAddProduct" class = "openCloseAddProduct">Добавить товар</button>
        <!--  Кнопки админа (КОНЕЦ) -->



        <!--<div id="result_form">-->
            <!--ProductId: ${productId}-->
            <!--ProductName: ${productName}-->
        <!--</div>-->
        <div id="result"></div>


        <ul class="products">

            <!--c:forEach items="${products}" var="product"-->
                <span th:each="product : ${products}">
                    <!--<th:each="product : ${products}">-->

                <!--c:if test="${category.id==product.category}"-->
                <div th:if="${category.id==product.category}">

                    <li class="product" th:id="@{'a'+${category.id}+${product.id}}">

                    <!--  Кнопки админа -->
                       <!--<button th:href="@{'/products/'+${product.id}+'/edit'}" class = "openCloseAddProduct">-->
                            <!--<img src="/images/pencil.png" title="Редактировать товар" alt="Редактировать товар">-->
                        <!--</button>-->
                        <button th:onclick="'crunchifyAjax('+${product.id}+')'" class = "openCloseAddProduct">Ajax</button>
                        <!--<form action="" method="post"  id="ajax_form" >-->
                          <!--productId:   <input name="productId"/>-->
                            <!--<input type="submit" value="Submit">-->
                        <!--</form>-->
                        <a th:href="@{'/products/'+${product.id}+'/edit'}" class = "openCloseAddProduct">
                            <img src="/images/pencil.png" title="Редактировать товар" alt="Редактировать товар">
                        </a>

                        <a th:href="@{'/products/'+${product.id}+'/delete'}" class = "openCloseAddProduct">
                            <img src="/images/delete.png" title="Удалить товар" alt="Удалить товар">
                        </a>

                        <!--  Кнопки админа (КОНЕЦ) -->

                        <div class="visibleSection" th:id="@{'b'+${category.id}+${product.id}}" th:onclick="@{'showHiddenTab(\'a'+${category.id}+${product.id}+'\', \'b'+${category.id}+${product.id}+'\', \'c'+${category.id}+${product.id}+'\');'}">

                            <div class="image">
                                <!--th:href="@{/order/details(orderId=${o.id})}-->
                                <img th:src="@{'images/'+${product.image}}">
                            </div>


                            <div class="productName" th:text=${product.name}>
                            </div>
                        </div>

                        <div class="hiddenSection" th:id="@{'c'+${category.id}+${product.id}}" th:onclick="@{'hideHiddenTab(\'a'+${category.id}+${product.id}+'\', \'b'+${category.id}+${product.id}+'\', \'c'+${category.id}+${product.id}+'\');'}">

                            <div class="image">
                                <img th:src="@{'images/'+${product.image}}">
                            </div>


                            <div class="price" th:text=${product.price}>
                            </div>

                            <button class="add">Да, я хочу этот корабль!</button>

                        </div>

                    </li>
                </div>

            <!--/c:forEach-->
            </span>
            <!--</th>-->
        </ul>
    <!--/c:forEach-->
    </div>

</div>

<div id="footer">
</div>

<script>

        function openClose() {
            $('#shoppingCart').toggle();
        }

    </script>

<script>
/*function crunchifyAjax() {
        $.ajax({
            url : '/ajaxtest',
            success : function(data) {
                $('#result').html(data);
            }
        });
    }*/
function crunchifyAjax(productId) {
        /*$.ajax({
            url : '/products/'+productId+'/edit',
            success : function(data) {
                $('#result').html(data);
            }
            /success : function(callback){
                $("#result").html(callback);
            },
        });*/

        var url = '/products/'+productId+'/edit';
        $("#ProductWindow2").load(url);
        /*$("#ProductWindow2").load(url,$("#productEdit").serialize());*/

    }

    </script>

<!--<script>-->
<!--/* Article FructCode.com */-->
<!--$( document ).ready(function() {-->
<!--$("#btn").click(-->
<!--function(){-->
<!--sendAjaxForm('result_form', 'ajax_form', 'action_ajax_form.php');-->
<!--return false;-->
<!--}-->
<!--);-->
<!--});-->

<!--function sendAjaxForm(result_form, ajax_form, url) {-->
<!--$.ajax({-->
<!--//url:     url, //url страницы (action_ajax_form.php)-->
<!--url:     /, //url страницы (action_ajax_form.php)-->
<!--type:     "POST", //метод отправки-->
<!--dataType: "html", //формат данных-->
<!--data: $("#"+ajax_form).serialize(),  // Сеарилизуем объект-->
<!--success: function(response) { //Данные отправлены успешно-->
<!--result = $.parseJSON(response);-->
<!--//$('#result_form').html('Имя: '+result.name+'<br>Телефон: '+result.phonenumber);-->
<!--$('#result_form').html('Id: '+result.productId+'<br>Наименование: '+result.productName);-->
<!--},-->
<!--error: function(response) { // Данные не отправлены-->
<!--$('#result_form').html('Ошибка. Данные не отправлены.');-->
<!--}-->
<!--});-->
<!--}-->
    <!--</script>-->

<script type="text/javascript" src="js/cart.js"></script>

<script type="text/javascript" src="js/search.js"></script>




<!--<script>-->
		<!--var modal = document.getElementById('myModal');-->
		<!--var btn = document.getElementById("myBtn");-->
		<!--var span = document.getElementsByClassName("close")[0];-->
		<!--btn.onclick = function() {-->
			<!--modal.style.display = "block";-->
		<!--}-->
		<!--span.onclick = function() {-->
			<!--modal.style.display = "none";-->
		<!--}-->
		<!--window.onclick = function(event) {-->
			<!--if (event.target == modal) {-->
				<!--modal.style.display = "none";-->
			<!--}-->
		<!--}-->
		<!--//2-->
		<!--var searchModel = document.getElementById('mySearch');-->
		<!--var btn1 = document.getElementById("myBtn1");-->
		<!--var span1 = document.getElementsByClassName("close")[0];-->
		<!--btn1.onclick = function() {-->
			<!--searchModel.style.display = "block";-->
		<!--}-->
		<!--span1.onclick = function() {-->
			<!--searchModel.style.display = "none";-->
		<!--}-->
		<!--window.onclick = function(event) {-->
			<!--if (event.target == searchModel) {-->
				<!--searchModel.style.display = "none";-->
			<!--}-->
		<!--}-->
	<!--</script>-->


</body>

</html>